<app-page-heading [title]="'المحاسبه'" [subtitle]="'استلام الدفعات'" [explorerBtn]="true" [AddRoute]="'/dashboard/paymentreceiptvoucher/explorerpaymentreceiptvoucher'" [TitlePageExplorerBtn]="'مستكشف الاستلام'"></app-page-heading>
<app-searchinforms [dataFilter]="dataFilter" (selectedDataFilter)="selectFilterData($event)"></app-searchinforms>


<form action="" class="forms_dashboard" [formGroup]="formSearchData">
         <div class="row row_part m-auto px-0">

     
<div class="pt-3 readonly_container" style="border: 1px solid #BFDBC9; border-radius: 4px; ">
    <div class="row">
<div class="mb-3 col-sm-12  col-lg-6 readonly_input">
                 <label for="numbercontract" class="form-label">رقم العقد</label>
                 <input type="text" style="padding-right: 75px;"  class="form-control" id="numbercontract" readonly   
        name="fullName" formControlName="numbercontract">
        </div>
        <div class="mb-3 col-sm-12  col-lg-6 readonly_input">
                 <label for="nametenant" class="form-label"  >اسم المستاجر</label>
              
                 <input type="text" formControlName="nameTenant" name="nametenant" readonly style="padding-right: 100px;" id="nametenant"  class="form-control" >
        </div>

         <div class="mb-3 col-sm-12  col-lg-3 readonly_input">
                 <label for="loneliness" class="form-label" >الوحده</label>
                 <input type="text" class="form-control" formControlName="unitName" readonly id="loneliness"  style="padding-right: 60px;" >
        </div>
         <div class="mb-3 col-sm-12  col-lg-3 readonly_input">
                 <label for="property" class="form-label" >العقار</label>
                 <input type="text" class="form-control" formControlName="propertyName" readonly id="property"  style="padding-right: 60px;" >
        </div>
         <div class="mb-3 col-sm-12  col-lg-3 readonly_input">
                 <label for="enddate" class="form-label" >تاريخ نهايه العقد</label>
                 <input type="text" class="form-control"formControlName="endDate" readonly id="enddate"  style="padding-right: 115px;" >
        </div>
              

       <div class="mb-3 col-sm-12  col-lg-3 readonly_input">
                 <label  class="form-label" >مبلغ العقد </label>
 

            <input type="text" class="form-control" formControlName="amountDue" style="padding-right: 80px;" id="idnumber" >
 </div>  



       


  

      </div>
      </div>
      </div>
</form>


<form class="forms_dashboard mt-4" [formGroup]="PaymentReceiptVoucherForm" (ngSubmit)="onSubmit()">
<div class="row">
     <div class="row ">
<div class=" col-sm-12  col-lg-3 ">
                 <label for="vouchernumber" class="form-label">رقم السند</label>
                 <input type="text" class="form-control"  id="vouchernumber" placeholder="رقم السند" readonly [value]="'0'" #numberVoucher>
                
        </div>
  <div class="col-sm-12 col-lg-3 mb-3 search_contract" style="margin-top: 7px;">
        <label  class="form-label" ></label>
        <div class="search_number_component">
<input type="text" name="" placeholder="بحث برقم السند" (keydown.enter)="searchById(valSearchById)"  class="form-control" appNoString #valSearchById>

<div class="search" (click)="searchById(valSearchById)">
    <svg width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M10.7501 17.4998C6.37783 17.4998 2.83342 13.9554 2.83342 9.58317C2.83342 5.21092 6.37783 1.6665 10.7501 1.6665C15.1223 1.6665 18.6667 5.21092 18.6667 9.58317C18.6667 13.9554 15.1223 17.4998 10.7501 17.4998Z" stroke="#7F7F7F" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M2.00008 18.3332L3.66675 16.6665" stroke="#7F7F7F" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

</div>
        </div>
        
    </div>

    <div class="col-sm-12 col-lg-3">
        <div class="mb-3">
            <label for="numbernotes" class="form-label">رقم الدفتري</label>
            <input type="text" class="form-control" id="numbernotes" placeholder="رقم الدفتري" formControlName="voucherNo">
 <app-formerror-msg [control]="this.PaymentReceiptVoucherForm.controls['voucherNo']" [Messages]="{
                  'required':'الرقم الدفتري مطلوب',
                  'minlength':'الرقم الدفتري يجب ان يكون اكثر من 3 حروف'
               }"></app-formerror-msg>            
          </div>
    </div>

    <div class="col-sm-12 col-lg-3">
        <div class="mb-3">
            <label for="date" class="form-label">التاريخ</label>
            <input type="date" class="form-control" id="date" placeholder="التاريخ" formControlName="voucherDate">
               <app-formerror-msg [control]="this.PaymentReceiptVoucherForm.controls['voucherDate']" [Messages]="{
                  required:'التاريخ مطلوب'
               }"></app-formerror-msg>
          </div>
    </div>
    <div class="col-sm-12 col-lg-4">
        <div class="mb-3">
            <label for="box" class="form-label">صندوق / بنك</label>
            <ng-select [items]="accountData" bindLabel="name" bindValue="financiallyAccountId"  placeholder="صندوق / بنك" formControlName="debitAccountId"></ng-select>
               <app-formerror-msg [control]="this.PaymentReceiptVoucherForm.controls['debitAccountId']" [Messages]="{
                  required:'صندوق / بنك مطلوب'
               }"></app-formerror-msg>
          </div>
    </div>
    <div class="col-sm-12 col-lg-4">
        <div class="mb-3">
            <label for="box" class="form-label">اختيار الشهر</label>
           <!-- <div>
            <input type="text" class="form-control" id="box" >
           </div> -->
             <div class="input_rent_container" >
                <input type="text"  id="monthsInput"  class="form-control"  placeholder="اختيار الشهر" readonly >

                <div class="months" *ngIf="getMonthes.length > 0">

                  <div class="prev_month" (click)="prevMonth()">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<rect x="16" y="16" width="16" height="16" rx="2" transform="rotate(180 16 16)" fill="#D4AF37"/>
<path d="M10.0605 2.72003L5.71388 7.0667C5.20055 7.58003 5.20055 8.42003 5.71388 8.93336L10.0605 13.28" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

                  </div>
                  <div class="container_months" #monthsContainer>
                    @for(item of getMonthes; track $index){
                  <div class="box" (click)="toggleActive($index,item)"  #getMothesElement  [ngClass]="{'active': activeIndexes.includes($index),'paidZero':item.paid == 0}">
                    <p>{{this.allMothes[item.monthIndex] || this.allMothes[item.monthNumber]}}</p>
                    2025
                  </div>
                      
                    }
              
                  <!-- <div class="box">
                    ديسمبر
                    2025
                  </div>
                  <div class="box">
                    ديسمبر
                    2025
                  </div> -->
                  </div>


                  <div class="next_months" (click)="nextMonth()">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect width="16" height="16" rx="2" transform="matrix(1 0 0 -1 0 16)" fill="#D4AF37"/>
                      <path d="M5.93945 2.72003L10.2861 7.0667C10.7995 7.58003 10.7995 8.42003 10.2861 8.93336L5.93945 13.28" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>

                  </div>
               
                </div>
              
            </div>
          </div>
    </div>
      <div class="col-sm-12 col-lg-4">
        <div class="mb-3">
            <label for="numbernotes" class="form-label">المبلغ</label>
            <input type="text" class="form-control" [value]="getTotalAmount || ''" id="numbernotes" placeholder="المبلغ"  formControlName="amount" readonly>
            <app-formerror-msg [control]="this.PaymentReceiptVoucherForm.controls['amount']" [Messages]="{
                  'required':'المبلغ مطلوب',
                  'minlength':'المبلغ يجب ان يكون اكثر من 3 حروف'
            }"></app-formerror-msg>
          
          </div>
    </div>
    <div class="col-sm-12">
        <div class="mb-3">
            <label for="byan" class="form-label">البيان</label>
            <textarea class="form-control" id="byan" rows="3" placeholder="اكتب المحتوي"  formControlName="notes" style="height: 109px !important;"></textarea>
          </div>
    </div>
          </div>

   

</div>


  <div class="btn_add_reset">
 <button data-type="save" data-button="send" type="submit" [ngClass]="{'btnEdit':this.btnAddandUpdate=='update','btnAdd':this.btnAddandUpdate=='add'}" >{{this.btnAddandUpdate == 'add' ? 'اضافه':"تعديل"}}</button>
 <button data-button="reset" type="button" (click)="resetForm()">جديد</button>
 <button data-button="reset" type="button" (click)="showDeletePopup()">حذف</button>
 <button data-button="reset">طباعه </button>
  </div>





</form>



<app-confirm-delete [isVisible]="showDelete" (onDelete)="deleteConfirmed($event)" [itemId]="this.deleteId" (toggleModal)="onClose()"></app-confirm-delete>
